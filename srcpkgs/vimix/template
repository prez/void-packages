# Template file for 'vimix'
pkgname=vimix
version=0.7.2
revision=1
build_style=cmake
configure_args="-DCMAKE_BUILD_TYPE=Release"
hostmakedepends="pkg-config git cmake"
makedepends="gtk+3-devel icu-devel glfw-devel libpng-devel tinyxml2-devel glm
 gstreamer1-devel gst-plugins-base1-devel gst-plugins-good1 gst-plugins-bad1-devel gst-plugins-ugly1 gst-libav"
depends="gstreamer1 gst-plugins-base1 gst-plugins-good1 gst-plugins-bad1 gst-plugins-ugly1 gst-libav"
short_desc="Live Video Mixer"
maintainer="prez <prez@national.shitposting.agency>"
license="GPL-3.0-or-later"
homepage="https://github.com/brunoherbelin/vimix"
_Dirent_commit=c885633e126a3a949ec0497273ec13e2c03e862c
_ImGuiColorTextEdit_commit=0a88824f7de8d0bd11d8419066caa7d3469395c4
_imgui_commit=0850b46c88daa92443dedf8609a80dbc1da52558
_stb_commit=f54acd4e13430c5122cab4ca657705c84aa61b08
_tfd_commit=2681e426ddaebc8e2764a7823b4b9d69564d1684
_link_commit=14f6cc99ac41466d52ce780aa37e432fe92c289b
_asio_commit=01b4e87c04abd4daec58e40463bcdc150085b269
distfiles="
 https://github.com/brunoherbelin/vimix/archive/${version}.tar.gz>vimix-${version}.tar.gz
 https://github.com/tronkko/dirent/archive/${_Dirent_commit}.tar.gz>dirent-${_Dirent_commit}.tar.gz
 https://github.com/BalazsJako/ImGuiColorTextEdit/archive/${_ImGuiColorTextEdit_commit}.tar.gz>ImGuiColorTextEdit-${_ImGuiColorTextEdit_commit}.tar.gz
 https://github.com/ocornut/imgui/archive/${_imgui_commit}.tar.gz>imgui-${_imgui_commit}.tar.gz
 https://github.com/nothings/stb/archive/${_stb_commit}.tar.gz>stb-${_stb_commit}.tar.gz
 https://sourceforge.net/code-snapshots/git/t/ti/tinyfiledialogs/code.git/tinyfiledialogs-code-${_tfd_commit}.zip>tinyfiledialogs-${_tfd_commit}.zip
 https://github.com/Ableton/link/archive/${_link_commit}.tar.gz>link-${_link_commit}.tar.gz
 https://github.com/chriskohlhoff/asio/archive/${_asio_commit}.tar.gz>asio-${_asio_commit}.tar.gz"
checksum="
 b67843e8264b11dcc4ded29a78e864a09838a220632ff6668389fa36df99307f
 aab1f1d02c3148a3d49a18b8de878603263e62e4a48622121efec92e5b40710b
 55063528d8a66dc081dd9cad239feadc447f2ffe14a41273bb0c3889d87a1a00
 ceb34285fa722a7aab23efb474320955ac2163f9a064c899d4a42f9120f27f08
 bf403306246d37e1f03168aea47d4841aaec62f1c7b1e7bf43bf9f9d9e069e2d
 9447c1cf119e2e8d56e765ce38a236ca46616e8751fb763848948d59bbeb872c
 d24ed32e0dc3b3183480157782493502bcc2e21c1bce3f93c999dfeaa7b24d1e
 c8cce67ed6035887cdfc1fff62b6c994f03940fef6b19b8ff6e5e4177b0e335e"

pre_configure() {
	cd "vimix-${version}"

	rmdir ext/Dirent
	rmdir ext/ImGuiColorTextEdit
	rmdir ext/imgui
	rmdir ext/stb
	rmdir ext/tfd
	rmdir ext/link

	mv -v ../dirent-${_Dirent_commit} ext/Dirent
	mv -v ../ImGuiColorTextEdit-${_ImGuiColorTextEdit_commit} ext/ImGuiColorTextEdit
	mv -v ../imgui-${_imgui_commit} ext/imgui
	mv -v ../stb-${_stb_commit} ext/stb
	mv -v ../tinyfiledialogs-code-${_tfd_commit} ext/tfd
	mv -v ../link-${_link_commit} ext/link

	rmdir ext/link/modules/asio-standalone
	mv -v ../asio-${_asio_commit} ext/link/modules/asio-standalone

	cd ..
	mv -v "vimix-${version}/"* .

	rm -rf "vimix-${version}"
}
